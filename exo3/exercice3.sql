/*Création de la table temporaire*/
CREATE TABLE tableTemp (
id INT UNSIGNED NOT NULL AUTO_INCREMENT,
state VARCHAR(128) NOT NULL,
typeState VARCHAR(48) NOT NULL,
PitLatrine INT NOT NULL,
WaterCloset INT NOT NULL,
OtherLatrine INT NOT NULL,
NoLatrine INT NOT NULL,
Mud INT NOT NULL,
WoodBamboo INT NOT NULL,
Brick INT NOT NULL,
Stone INT NOT NULL,
Cement INT NOT NULL,
Mosaic INT NOT NULL,
OthersMaterials INT NOT NULL,
PRIMARY KEY(id)
);

/*Insertion de TOUTES les données dans la table temporaire*/
INSERT INTO tableTemp (state, typeState, PitLatrine, WaterCloset, OtherLatrine, NoLatrine, Mud, WoodBamboo, Brick, Stone, Cement, Mosaic, OthersMaterials)
VALUES
("STATE - ANDHRA PRADESH  28","Rural",809705,1093148,397842,10375523,7997880,45420,94488,3829081,2931084,84033,48655),
("STATE - ANDHRA PRADESH  28","Urban",630179,1960525,667807,915128,496367,10447,28101,2362869,1558039,473033,50847),
("STATE - ARUNACHAL PRADESH  12","Rural",39513,9940,28418,86630,62617,116707,292,401,37272,89,388),
("STATE - ARUNACHAL PRADESH  12","Urban",15434,13499,12903,6278,20571,10794,309,377,33669,147,127),
("STATE - ASSAM  18","Rural",1979800,363519,170485,1706369,4536303,190347,49671,19399,387350,8810,2410),
("STATE - ASSAM  18","Urban",188702,421092,66741,38650,389088,18905,27090,11562,503712,23629,718),
("STATE - BIHAR  10","Rural",755668,526492,479431,10898416,12768815,86920,344648,35388,1305839,27232,7064),
("STATE - BIHAR  10","Urban",150391,574602,196767,400823,621004,13685,82412,10721,948452,63331,1016),
("STATE - CHHATTISGARH  22","Rural",59659,61434,52901,3185084,3591454,7716,9415,149724,248636,8881,1896),
("STATE - CHHATTISGARH  22","Urban",40676,306495,68034,374235,353191,2506,6200,127069,423907,67147,984),
("STATE - GOA  30","Rural",26636,29316,11911,72892,105529,391,850,1245,77329,38726,613),
("STATE - GOA  30","Urban",25948,53831,16080,42602,36384,704,1034,1393,99997,93363,1310),
("STATE - GUJARAT  24","Rural",475894,663847,134782,4611438,4452316,19276,33951,327585,1819712,857525,14808),
("STATE - GUJARAT  24","Urban",366410,2334150,326408,731060,376692,13349,21264,568100,1357705,2558329,26383),
("STATE - HARYANA  06","Rural",502207,51845,149461,1750950,1916218,5375,520770,35181,1003792,56099,7049),
("STATE - HARYANA  06","Urban",284714,333201,249377,207887,220096,3282,155829,78591,976468,119526,7999),
("STATE - HIMACHAL PRADESH  02","Rural",164167,70258,69777,793318,1297320,228996,6528,50324,571209,10132,3830),
("STATE - HIMACHAL PRADESH  02","Urban",17166,71153,22197,32597,28127,7030,1518,1879,192280,9034,715),
("STATE - JAMMU & KASHMIR  01","Rural",190753,33450,261231,675923,1555302,151794,9660,8926,391929,4661,3214),
("STATE - JAMMU & KASHMIR  01","Urban",78751,103602,156815,51243,130680,20299,5125,3239,464219,17996,1508),
("STATE - JHARKHAND  20","Rural",80582,84693,84517,3552620,3801701,6243,48437,6281,619037,4861,2647),
("STATE - JHARKHAND  20","Urban",78521,437172,191197,353288,339473,6704,27843,4361,935525,34438,971),
("STATE - KARNATAKA  29","Rural",632514,311500,217245,5513914,4910985,41439,41400,1418565,2407358,132880,45854),
("STATE - KARNATAKA  29","Urban",736283,1595616,343868,881193,534482,17031,23660,853468,2467362,912206,23406),
("STATE - KERALA  32","Rural",631664,3063983,324374,922529,1791236,21667,53279,80733,4505922,392957,48982),
("STATE - KERALA  32","Urban",183557,1235462,101728,131909,284427,5094,22466,17821,1716511,378387,37392),
("STATE - MADHYA PRADESH  23","Rural",315561,213056,197601,7398577,9209664,18594,45042,321367,654200,131912,11758),
("STATE - MADHYA PRADESH  23","Urban",332437,1148702,412089,901630,1103837,12342,25222,512506,1349038,615130,8734),
("STATE - MAHARASHTRA  27","Rural",1124458,585470,292008,8991687,10777153,64916,105431,533788,1126947,1658651,142109),
("STATE - MAHARASHTRA  27","Urban",571036,3580166,535330,3382994,1412513,48147,74552,551808,2530113,6316465,258796),
("STATE - MANIPUR  14","Rural",198029,13708,17925,66692,286826,48365,2112,1671,22342,586,127),
("STATE - MANIPUR  14","Urban",67834,20815,7904,4749,92392,2604,2237,1344,30153,1426,186),
("STATE - MEGHALAYA  17","Rural",98370,12339,21490,197479,173749,167671,1588,1209,55987,370,818),
("STATE - MEGHALAYA  17","Urban",30005,39435,13505,7623,16345,40313,431,792,59981,1020,328),
("STATE - MIZORAM  15","Rural",55677,3271,4337,16077,7330,76349,83,106,7142,4,174),
("STATE - MIZORAM  15","Urban",44477,28170,7353,1604,7194,56040,164,105,34948,249,181),
("STATE - NAGALAND  13","Rural",125410,15705,30410,93809,187841,68061,1573,1379,35331,551,182),
("STATE - NAGALAND  13","Urban",27000,13255,22539,3922,25835,13717,577,391,43670,1181,56),
("STATE - ORISSA  21","Rural",209472,223290,90510,6259607,6507071,72064,78575,39601,1661232,13539,6425),
("STATE - ORISSA  21","Urban",103055,468113,77767,438313,391466,35953,16897,6799,992842,48400,2165),
("STATE - PUNJAB  03","Rural",731747,177292,226487,1639936,1907982,6549,655972,104777,1063286,59930,6579),
("STATE - PUNJAB  03","Urban",305813,692949,290145,200787,288532,5585,342473,283772,1149899,81937,10203),
("STATE - RAJASTHAN  08","Rural",579921,227428,238036,6111318,5634567,17450,133296,879243,2892857,124357,55774),
("STATE - RAJASTHAN  08","Urban",397910,886868,378726,522087,358679,6368,75403,676792,1704100,353253,25594),
("STATE - SIKKIM  11","Rural",27296,22326,4816,37285,44708,24060,204,2225,38078,475,205),
("STATE - SIKKIM  11","Urban",251,11322,373,1069,637,1039,25,56,16250,876,5),
("STATE - TAMIL NADU  33","Rural",377122,609067,201730,7086871,4178613,12476,181770,44746,5095522,199742,11842),
("STATE - TAMIL NADU  33","Urban",658193,2682181,454527,2103935,955203,9546,148668,31472,5024425,1080325,22254),
("STATE - TRIPURA  16","Rural",356303,24631,39650,119096,618452,30644,11307,831,39045,674,202),
("STATE - TRIPURA  16","Urban",54806,52763,11051,3723,83829,1220,7774,737,66737,1638,93),
("STATE - UTTAR PRADESH  09","Rural",1716646,401200,1840724,16631504,23548929,82547,1135947,97578,2180738,115504,17740),
("STATE - UTTAR PRADESH  09","Urban",934442,1653335,1549079,1033671,1766174,31881,827258,144213,3924493,416239,12214),
("STATE - UTTARANCHAL  05","Rural",192541,85770,99685,818161,1389703,52751,21658,71481,461179,12953,2905),
("STATE - UTTARANCHAL  05","Urban",104258,159255,75478,51173,75802,3384,12336,5481,404278,51714,657),
("STATE - WEST BENGAL  19","Rural",1712827,778345,514682,8156016,11441120,151907,415797,50849,2307003,30558,16077),
("STATE - WEST BENGAL  19","Urban",1042595,2513682,307646,690122,1245696,59323,194141,29636,3872338,318914,6798),
("UNION TERRITORY - ANDAMAN & NICOBAR ISLANDS  35","Rural",6154,9127,5737,28635,34822,5077,121,181,31392,91,152),
("UNION TERRITORY - ANDAMAN & NICOBAR ISLANDS  35","Urban",1578,13739,2589,5503,2660,1478,136,108,27636,343,25),
("UNION TERRITORY - CHANDIGARH  04","Rural",1363,10137,3098,6704,2605,52,1265,118,22095,269,24),
("UNION TERRITORY - CHANDIGARH  04","Urban",1849,127789,14950,35988,23578,279,4111,5703,160327,20269,3439),
("UNION TERRITORY - DADRA & NAGAR HAVELI  26","Rural",74,5538,67,27104,25886,36,295,404,8108,6086,109),
("UNION TERRITORY - DADRA & NAGAR HAVELI  26","Urban",388,8010,241,2551,2391,31,166,481,5950,7381,179),
("UNION TERRITORY - DAMAN & DIU  25","Rural",2069,4468,537,15017,5494,88,77,308,21840,6453,55),
("UNION TERRITORY - DAMAN & DIU  25","Urban",419,7418,179,4235,787,81,102,542,8978,9032,65),
("UNION TERRITORY - DELHI  07","Rural",55767,32255,18586,62920,47809,311,24879,4947,147382,18494,866),
("UNION TERRITORY - DELHI  07","Urban",362087,1129239,393275,500020,213832,4790,120231,92931,2266101,427073,10310),
("UNION TERRITORY - LAKSHADWEEP  31","Rural",20,4881,83,367,1390,1,12,3,7759,261,33),
("UNION TERRITORY - LAKSHADWEEP  31","Urban",30,2729,499,631,753,2,9,4,5830,338,212),
("UNION TERRITORY - PONDICHERRY  34","Rural",708,14325,434,56732,36591,88,600,227,49992,2440,41),
("UNION TERRITORY - PONDICHERRY  34","Urban",2994,81057,4692,47713,25155,203,928,428,120156,29677,680);

/*Insertion des données dans les tables correspondantes*/
INSERT INTO etat (nomEtat, typeEtat)
SELECT state, typeState
FROM tableTemp;

INSERT INTO latrines (libLatrine)
VALUES
("Pit Latrine"),
("Water Closet"),
("Other Latrine"),
("No Latrine");

INSERT INTO typesol (libTypeSol)
VALUES
("Mud"),
("Wood, Bamboos"),
("Brick"),
("Stone"),
("Cement"),
("Mosaic, Floortiles"),
("Any other material");

/*INSERTION DES STATISTIQUES*/
/*Latrines*/
INSERT INTO statslatrines (nbresLatrines)
SELECT PitLatrine
FROM tableTemp;

INSERT INTO statslatrines (nbresLatrines)
SELECT WaterCloset
FROM tableTemp;

INSERT INTO statslatrines (nbresLatrines)
SELECT OtherLatrine
FROM tableTemp;

INSERT INTO statslatrines (nbresLatrines)
SELECT NoLatrine
FROM tableTemp;

/*SOL*/
INSERT INTO statssol (nbresSol)
SELECT Mud
FROM tableTemp;

INSERT INTO statssol (nbresSol)
SELECT WoodBamboo
FROM tableTemp;

INSERT INTO statssol (nbresSol)
SELECT Brick
FROM tableTemp;

INSERT INTO statssol (nbresSol)
SELECT Stone
FROM tableTemp;

INSERT INTO statssol (nbresSol)
SELECT Cement
FROM tableTemp;

INSERT INTO statssol (nbresSol)
SELECT Mosaic
FROM tableTemp;

INSERT INTO statssol (nbresSol)
SELECT OthersMaterials
FROM tableTemp;

/*Jointure stats and latrines*/
INSERT INTO statsandlatrines (idLatrine, idNbresLatrines)
SELECT lts.idLatrine, sl.idNbresLatrines
FROM statslatrines sl
INNER JOIN tableTemp tt ON tt.PitLatrine = sl.nbresLatrines
INNER JOIN latrines lts ON lts.libLatrine = "Pit Latrine";

INSERT INTO statsandlatrines (idLatrine, idNbresLatrines)
SELECT lts.idLatrine, sl.idNbresLatrines
FROM statslatrines sl
INNER JOIN tableTemp tt ON tt.WaterCloset = sl.nbresLatrines
INNER JOIN latrines lts ON lts.libLatrine = "Water Closet";

INSERT INTO statsandlatrines (idLatrine, idNbresLatrines)
SELECT lts.idLatrine, sl.idNbresLatrines
FROM statslatrines sl
INNER JOIN tableTemp tt ON tt.OtherLatrine = sl.nbresLatrines
INNER JOIN latrines lts ON lts.libLatrine = "Other Latrine";

INSERT INTO statsandlatrines (idLatrine, idNbresLatrines)
SELECT lts.idLatrine, sl.idNbresLatrines
FROM statslatrines sl
INNER JOIN tableTemp tt ON tt.NoLatrine = sl.nbresLatrines
INNER JOIN latrines lts ON lts.libLatrine = "No Latrine";

/*Jointure stats and sol*/
INSERT INTO statsandsol (idTypeSol, idNbresSol)
SELECT ts.idTypeSol, ss.idNbresSol
FROM statssol ss
INNER JOIN tableTemp tt ON tt.Mud = ss.nbresSol
INNER JOIN typesol ts ON ts.libTypeSol = "Mud";

INSERT INTO statsandsol (idTypeSol, idNbresSol)
SELECT ts.idTypeSol, ss.idNbresSol
FROM statssol ss
INNER JOIN tableTemp tt ON tt.WoodBamboo = ss.nbresSol
INNER JOIN typesol ts ON ts.libTypeSol = "Wood, Bamboos";

INSERT INTO statsandsol (idTypeSol, idNbresSol)
SELECT ts.idTypeSol, ss.idNbresSol
FROM statssol ss
INNER JOIN tableTemp tt ON tt.Brick = ss.nbresSol
INNER JOIN typesol ts ON ts.libTypeSol = "Brick";

INSERT INTO statsandsol (idTypeSol, idNbresSol)
SELECT ts.idTypeSol, ss.idNbresSol
FROM statssol ss
INNER JOIN tableTemp tt ON tt.Stone = ss.nbresSol
INNER JOIN typesol ts ON ts.libTypeSol = "Stone";

INSERT INTO statsandsol (idTypeSol, idNbresSol)
SELECT ts.idTypeSol, ss.idNbresSol
FROM statssol ss
INNER JOIN tableTemp tt ON tt.Cement = ss.nbresSol
INNER JOIN typesol ts ON ts.libTypeSol = "Cement";

INSERT INTO statsandsol (idTypeSol, idNbresSol)
SELECT ts.idTypeSol, ss.idNbresSol
FROM statssol ss
INNER JOIN tableTemp tt ON tt.Mosaic = ss.nbresSol
INNER JOIN typesol ts ON ts.libTypeSol = "Mosaic, Floortiles";

INSERT INTO statsandsol (idTypeSol, idNbresSol)
SELECT ts.idTypeSol, ss.idNbresSol
FROM statssol ss
INNER JOIN tableTemp tt ON tt.OthersMaterials = ss.nbresSol
INNER JOIN typesol ts ON ts.libTypeSol = "Any other material";